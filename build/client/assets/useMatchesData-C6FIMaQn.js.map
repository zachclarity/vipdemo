{"version":3,"file":"useMatchesData-C6FIMaQn.js","sources":["../../../app/lib/hooks/useMatchesData.ts"],"sourcesContent":["import type { Models } from '@lib/models.server';\nimport type { Organization } from '@prisma/client';\nimport { useMatches } from '@remix-run/react';\nimport type { OrganizationWithChildren } from '@repositories/organization.server';\n\nexport type RootLayoutData = {\n  user: {\n    name: string;\n    image: string | null;\n    rank: string;\n    id: string;\n    primaryEmail: string;\n  };\n  roles: Array<{\n    abbreviation: string;\n    description: string;\n    id: string;\n    name: string;\n    owningOrgId: string;\n    roleId: string;\n  }>;\n  permissions: string;\n  org: Organization;\n  parentNode: OrganizationWithChildren,\n  orgFlatArray: Array<Organization>\n};\n\nfunction isValidReturnKey(returnKey: unknown): returnKey is keyof RootLayoutData {\n  return ['user', 'roles', 'permissions', 'org', 'parentNode', 'orgFlatArray'].includes(returnKey);\n}\n\nfunction isRootLayoutData(data: unknown): data is RootLayoutData {\n  return !!(data as RootLayoutData).user && !!(data as RootLayoutData).roles && !!(data as RootLayoutData).permissions && !!(data as RootLayoutData).org;\n}\n\ntype DataOrKeyValue<T extends keyof RootLayoutData | string> = T extends keyof RootLayoutData ? RootLayoutData[T] : RootLayoutData\n\nexport function useRootLayoutData<K extends keyof RootLayoutData | string>(\n  returnKey?: K\n): DataOrKeyValue<K> {\n  const data = useMatchesData('routes/_withNav+/_layout');\n  let errMsg = '';\n\n  if (!data || !isRootLayoutData(data)) {\n    // Handle case when data is not available\n    errMsg = 'No layout data available.';\n    console.error(errMsg);\n    throw new Error(errMsg);\n  }\n\n  if (!returnKey) {\n    return data as DataOrKeyValue<K>;\n  }\n\n  if (!isValidReturnKey(returnKey)) {\n    errMsg = `Invalid key ${returnKey}.`;\n    console.error(errMsg);\n    throw new Error(errMsg);\n  }\n\n  return (data[returnKey] as DataOrKeyValue<K>);\n}\n\nexport function useManageLayoutData() {\n  const data = useMatchesData('routes/_withNav+/_withSideBar+/_manage+/_layout');\n\n  return (\n      data as {\n        parentNode: OrganizationWithChildren,\n        orgFlatArray: Array<Organization>,\n        orgBeingViewed: Organization;\n        orgSelected: Organization;\n      }\n  );\n}\nexport type ChecklistLayoutData = {item: Awaited<ReturnType<typeof Models.checklistItem.getWithComments>>[0]; comments: Awaited<ReturnType<typeof Models.checklistItem.getWithComments>>[1]; loggedInUser: string;}\n\nexport function useChecklistLayoutData() {\n  const data = useMatchesData('routes/_withNav+/_noSideBar+/checklist.$itemId+/_layout');\n  return (\n    data as ChecklistLayoutData\n  );\n}\n\nexport function useManageTemplateData() {\n  const data = useMatchesData('routes/_withNav+/_withSideBar+/_manage+/template');\n\n  type TemplateType = {\n    id: string,\n    createdAt: string,\n    updatedAt: string,\n    isDeleted: boolean,\n    createdBy: string,\n    updatedBy: string,\n    name: string,\n    abbreviation: string,\n    isWingLevel: boolean,\n    parentOrgId: string,\n    parentId: string,\n    baseId: string,\n    templates: Array<{\n      id: string,\n      name: string,\n      description: string,\n      isDeleted: boolean,\n      organizationId: string,\n      type: string,\n    }>;\n  }\n\n  return (\n      data as {\n        orgBeingViewed: TemplateType;\n      }\n  );\n}\n\nexport default function useMatchesData(id: string) {\n  const matches = useMatches();\n  const match = matches.find(\n    (match) => match.id === id\n  );\n  if (match?.data)\n    return match.data;\n}\n"],"names":["isValidReturnKey","returnKey","isRootLayoutData","data","useRootLayoutData","useMatchesData","errMsg","useManageLayoutData","useChecklistLayoutData","useManageTemplateData","id","match","useMatches"],"mappings":"kYA2BA,SAASA,EAAiBC,EAAuD,CACxE,MAAA,CAAC,OAAQ,QAAS,cAAe,MAAO,aAAc,cAAc,EAAE,SAASA,CAAS,CACjG,CAEA,SAASC,EAAiBC,EAAuC,CAC/D,MAAO,CAAC,CAAEA,EAAwB,MAAQ,CAAC,CAAEA,EAAwB,OAAS,CAAC,CAAEA,EAAwB,aAAe,CAAC,CAAEA,EAAwB,GACrJ,CAIO,SAASC,EACdH,EACmB,CACb,MAAAE,EAAOE,EAAe,0BAA0B,EACtD,IAAIC,EAAS,GAEb,GAAI,CAACH,GAAQ,CAACD,EAAiBC,CAAI,EAExB,MAAAG,EAAA,4BACT,QAAQ,MAAMA,CAAM,EACd,IAAI,MAAMA,CAAM,EAGxB,GAAI,CAACL,EACI,OAAAE,EAGL,GAAA,CAACH,EAAiBC,CAAS,EAC7B,MAAAK,EAAS,eAAeL,CAAS,IACjC,QAAQ,MAAMK,CAAM,EACd,IAAI,MAAMA,CAAM,EAGxB,OAAQH,EAAKF,CAAS,CACxB,CAEO,SAASM,GAAsB,CAIhC,OAHSF,EAAe,iDAAiD,CAU/E,CAGO,SAASG,GAAyB,CAGrC,OAFWH,EAAe,yDAAyD,CAIvF,CAEO,SAASI,GAAwB,CA2BlC,OA1BSJ,EAAe,kDAAkD,CA8BhF,CAEA,SAAwBA,EAAeK,EAAY,CAEjD,MAAMC,EADUC,EAAW,EACL,KACnBD,GAAUA,EAAM,KAAOD,CAC1B,EACA,GAAIC,GAAA,MAAAA,EAAO,KACT,OAAOA,EAAM,IACjB"}