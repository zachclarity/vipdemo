{"version":3,"file":"role_.permissions._roleId-PsBYEtE1.js","sources":["../../../app/routes/_withNav+/_withSideBar+/_manage+/role_.permissions.$roleId.tsx"],"sourcesContent":["import { Checkbox } from '@components/ui/Input';\nimport { Modal } from '@components/ui/modals';\nimport { AttributeCategory, Operation } from '@lib/utils';\nimport { json, type LoaderFunctionArgs } from '@remix-run/node';\nimport { Form, useLoaderData } from '@remix-run/react';\nimport { getRole } from './.server/role.queries';\n\nexport async function loader({ params }: LoaderFunctionArgs) {\n  if (!params.roleId) throw new Error('role id is required');\n  const { permissions, ...role } = await getRole(params.roleId);\n  return json({\n    role,\n    permissions: JSON.parse(atob(permissions)),\n  });\n}\n\nexport default function EditPermissions() {\n  const { role, permissions } = useLoaderData<typeof loader>();\n  const permissionsMap = new Map<string, Operation[]>(permissions);\n\n  return (\n    <Modal>\n      <Form>\n        <div className=\"bg-white px-4 pb-4 pt-5 sm:p-6 sm:pb-4 mb-5\">\n          <Modal.Title>Edit Permissions for {role.name}</Modal.Title>\n          <div className=\"grid md:grid-cols-3 gap-5\">\n            {Object.entries(AttributeCategory)\n              .sort()\n              .map((val) => {\n                const hasRead =\n                  permissionsMap.get(val[1])?.includes(Operation.READ) ?? false;\n                const hasWrite =\n                  permissionsMap.get(val[1])?.includes(Operation.WRITE) ??\n                  false;\n                const hasDelete =\n                  permissionsMap.get(val[1])?.includes(Operation.DELETE) ??\n                  false;\n                return (\n                  val[0] !== 'ADMIN' && // TODO: SUPER ADMINS Will be the only ones able to change admin\n                  val[0] !== 'SUPERADMIN' && ( // no one should be able to edit super admin\n                    <div\n                      key={`${role.id}-${val[0]}`}\n                      className=\"border-b border-1 pb-5\">\n                      <label className=\"mb-2 block text-sm font-medium text-gray-700\">\n                        {val[0]}\n                      </label>\n                      <Checkbox\n                        label=\"Read\"\n                        defaultChecked={hasRead}\n                        name={`${val[0].toLowerCase()}-read`}/>\n                      <Checkbox\n                        label=\"Write\"\n                        defaultChecked={hasWrite}\n                        name={`${val[0].toLowerCase()}-write`}/>\n                      <Checkbox\n                        label=\"Delete\"\n                        defaultChecked={hasDelete}\n                        name={`${val[0].toLowerCase()}-del`}/>\n                    </div>\n                  )\n                );\n              })}\n          </div>\n        </div>\n        <Modal.Buttons link=\"/role/permissions\" value=\"edit\">\n          Save\n        </Modal.Buttons>\n      </Form>\n    </Modal>\n  );\n}\n"],"names":["EditPermissions","role","permissions","useLoaderData","permissionsMap","Map","jsx","Modal","children","jsxs","Form","className","Title","name","Object","entries","AttributeCategory","sort","map","val","hasRead","get","includes","Operation","READ","hasWrite","WRITE","hasDelete","DELETE","Checkbox","label","defaultChecked","toLowerCase","id","Buttons","link","value"],"mappings":"+1BAgBA,SAAwBA,GAAkB,CACxC,KAAM,CAAEC,KAAAA,EAAMC,YAAAA,CAAY,EAAIC,EAA6B,EACrDC,EAAiB,IAAIC,IAAyBH,CAAW,EAG7D,OAAAI,EAAAA,IAACC,EACC,CAAAC,SAAAC,EAAA,KAACC,EACC,CAAAF,SAAA,CAACC,EAAA,KAAA,MAAA,CAAIE,UAAU,8CACbH,SAAA,CAACC,EAAAA,KAAAF,EAAMK,MAAN,CAAYJ,SAAA,CAAA,wBAAsBP,EAAKY,IAAA,CAAK,CAAA,EAC5CP,EAAA,IAAA,MAAA,CAAIK,UAAU,4BACZH,SAAOM,OAAAC,QAAQC,CAAiB,EAC9BC,KAAK,EACLC,IAAKC,GAAQ,WACN,MAAAC,IACJhB,EAAAA,EAAeiB,IAAIF,EAAI,CAAC,CAAC,IAAzBf,YAAAA,EAA4BkB,SAASC,EAAUC,QAAS,GACpDC,IACJrB,EAAAA,EAAeiB,IAAIF,EAAI,CAAC,CAAC,IAAzBf,YAAAA,EAA4BkB,SAASC,EAAUG,SAC/C,GACIC,IACJvB,EAAAA,EAAeiB,IAAIF,EAAI,CAAC,CAAC,IAAzBf,YAAAA,EAA4BkB,SAASC,EAAUK,UAC/C,GAEA,OAAAT,EAAI,CAAC,IAAM,SACXA,EAAI,CAAC,IAAM,cACTV,EAAAA,KAAC,MAAA,CAECE,UAAU,yBACVH,SAAA,CAAAF,EAAA,IAAC,QAAM,CAAAK,UAAU,+CACdH,SAAAW,EAAI,CAAC,CACR,CAAA,EACAb,EAAA,IAACuB,EAAA,CACCC,MAAM,OACNC,eAAgBX,EAChBP,KAAM,GAAGM,EAAI,CAAC,EAAEa,YAAa,CAAA,OAAA,CAAQ,EACvC1B,EAAA,IAACuB,EAAA,CACCC,MAAM,QACNC,eAAgBN,EAChBZ,KAAM,GAAGM,EAAI,CAAC,EAAEa,YAAa,CAAA,QAAA,CAAS,EACxC1B,EAAA,IAACuB,EAAA,CACCC,MAAM,SACNC,eAAgBJ,EAChBd,KAAM,GAAGM,EAAI,CAAC,EAAEa,YAAa,CAAA,MAAA,CAAO,CAAA,GAhBjC,GAAG/B,EAAKgC,EAAE,IAAId,EAAI,CAAC,CAAC,EAiB3B,CAGL,CAAA,CACL,CAAA,CAAA,EACF,EACAb,EAAAA,IAACC,EAAM2B,QAAN,CAAcC,KAAK,oBAAoBC,MAAM,OAAO5B,SAErD,MAAA,CAAA,CAAA,CACF,CAAA,CACF,CAAA,CAEJ"}