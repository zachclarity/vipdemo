{"version":3,"file":"_userId.delete-CEOVzZVY.js","sources":["../../../node_modules/@heroicons/react/24/outline/esm/ExclamationCircleIcon.js","../../../app/routes/_withNav+/_withSideBar+/_manage+/user+/$userId.delete.tsx"],"sourcesContent":["import * as React from \"react\";\nfunction ExclamationCircleIcon({\n  title,\n  titleId,\n  ...props\n}, svgRef) {\n  return /*#__PURE__*/React.createElement(\"svg\", Object.assign({\n    xmlns: \"http://www.w3.org/2000/svg\",\n    fill: \"none\",\n    viewBox: \"0 0 24 24\",\n    strokeWidth: 1.5,\n    stroke: \"currentColor\",\n    \"aria-hidden\": \"true\",\n    \"data-slot\": \"icon\",\n    ref: svgRef,\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, /*#__PURE__*/React.createElement(\"path\", {\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\",\n    d: \"M12 9v3.75m9-.75a9 9 0 1 1-18 0 9 9 0 0 1 18 0Zm-9 3.75h.008v.008H12v-.008Z\"\n  }));\n}\nconst ForwardRef = /*#__PURE__*/ React.forwardRef(ExclamationCircleIcon);\nexport default ForwardRef;","import { DeleteButton } from '@components/ui/Buttons';\nimport ErrorReport from '@components/ui/ErrorReport';\nimport { Modal } from '@components/ui/modals';\nimport {\n  ExclamationCircleIcon,\n  ExclamationTriangleIcon,\n} from '@heroicons/react/24/outline';\nimport { Attribute } from '@lib/utils';\nimport type { ActionFunctionArgs, LoaderFunctionArgs } from '@remix-run/node';\nimport { Form, useNavigate, useParams } from '@remix-run/react';\nimport { requireUser } from '@services/user.server';\nimport { jsonWithError, redirectWithSuccess } from 'remix-toast';\nimport { z } from 'zod';\nimport { deleteAccount } from './.server/user.queries';\n\nexport async function loader({ request }: LoaderFunctionArgs) {\n  await requireUser(request, {\n    permissions: Attribute.MEMBERS_READWRITEDELETE,\n  });\n  return null;\n}\n\nexport async function action({ request }: ActionFunctionArgs) {\n  const orgParam = new URL(request.url).searchParams.get('org');\n  const updateAccountStatus = z.object({\n    userId: z.string(),\n    _action: z.literal('delete'),\n  });\n  try {\n    await requireUser(request, {\n      options: { redirectOnFailure: false },\n      permissions: Attribute.MEMBERS_READWRITEDELETE,\n    });\n\n    const { userId } = updateAccountStatus.parse(\n      Object.fromEntries((await request.formData()).entries())\n    );\n\n    await deleteAccount(userId);\n\n    return redirectWithSuccess(\n      `/user${orgParam ? `?org=${orgParam}` : ''}`,\n      'Account deleted!'\n    );\n  } catch (e) {\n    console.error(e);\n    return jsonWithError({ status: e }, 'Account could not be deleted', {\n      status: 500,\n    });\n  }\n  // return redirectWithSuccess(\n  //   `/user${orgParam ? `?org=${orgParam}` : ''}`,\n  //   'Member Saved!'\n  // );\n}\n\nexport default function DeleteAccountPage() {\n  const { userId } = useParams();\n  const navigate = useNavigate();\n\n  return (\n    <Modal>\n      <Form method=\"post\">\n        <input type=\"hidden\" name=\"userId\" value={userId} />\n        <div className=\"bg-white p-2\">\n          <div className=\"flex flex-col items-center justify-center\">\n            <ExclamationTriangleIcon className=\"w-10 h-10 stroke-red-600\" />\n            <h1 className=\"text-red-600 text-2xl\">Delete User Account</h1>\n          </div>\n        </div>\n        <div className=\"bg-gray-200\">\n          <div className=\"flex flex-col justify-center items-center p-5\">\n            <h2 className=\"mb-2 text-lg font-semibold text-gray-900 dark:text-white\">\n              Warning: this action cannot be undone.\n            </h2>\n            <ul className=\"max-w-md space-y-1 text-gray-500 list-inside dark:text-gray-400\">\n              <li className=\"flex items-center\">\n                <ExclamationCircleIcon className=\"w-5 h-5 mr-2 stroke-red-600\" />\n                The user will all lose access to thier account.\n              </li>\n              <li className=\"flex items-center\">\n                <ExclamationCircleIcon className=\"w-5 h-5 mr-2 stroke-red-600\" />\n                All historical data will be lost (metrics).\n              </li>\n              <li className=\"flex items-center\">\n                <ExclamationCircleIcon className=\"w-5 h-5 mr-2 stroke-red-600\" />\n                The account cannot be recovered.\n              </li>\n            </ul>\n          </div>\n          <div className=\"flex flex-row-reverse p-2\">\n            <DeleteButton\n              type=\"submit\"\n              name=\"_action\"\n              value=\"delete\"\n              className=\"inline-flex w-full justify-center rounded-md bg-red-600 px-3 py-2 text-sm font-semibold text-white shadow-sm hover:bg-red-500 sm:ml-3 sm:w-auto\">\n              Delete Account\n            </DeleteButton>\n            <button\n              type=\"button\"\n              onClick={() => navigate(-1)}\n              className=\"mt-3 inline-flex w-full justify-center rounded-md bg-white px-3 py-2 text-sm font-semibold text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 hover:bg-gray-50 sm:mt-0 sm:w-auto\">\n              Cancel\n            </button>\n          </div>\n        </div>\n      </Form>\n    </Modal>\n  );\n}\n\nexport const ErrorBoundary = ErrorReport;\n"],"names":["ExclamationCircleIcon","title","titleId","props","svgRef","React.createElement","ForwardRef","React.forwardRef","DeleteAccountPage","userId","useParams","navigate","useNavigate","jsx","Modal","children","jsxs","Form","method","type","name","value","className","ExclamationTriangleIcon","DeleteButton","onClick","ErrorBoundary","ErrorReport"],"mappings":"63BACA,SAASA,EAAsB,CAC7B,MAAAC,EACA,QAAAC,EACA,GAAGC,CACL,EAAGC,EAAQ,CACT,OAAoBC,gBAAoB,MAAO,OAAO,OAAO,CAC3D,MAAO,6BACP,KAAM,OACN,QAAS,YACT,YAAa,IACb,OAAQ,eACR,cAAe,OACf,YAAa,OACb,IAAKD,EACL,kBAAmBF,CACpB,EAAEC,CAAK,EAAGF,EAAqBI,EAAAA,cAAoB,QAAS,CAC3D,GAAIH,CACL,EAAED,CAAK,EAAI,KAAmBI,EAAAA,cAAoB,OAAQ,CACzD,cAAe,QACf,eAAgB,QAChB,EAAG,6EACP,CAAG,CAAC,CACJ,CACA,MAAMC,EAA2BC,EAAgB,WAACP,CAAqB,ECgCvE,SAAwBQ,GAAoB,CACpC,KAAA,CAAEC,OAAAA,CAAO,EAAIC,EAAU,EACvBC,EAAWC,EAAY,EAE7B,OACGC,EAAAA,IAAAC,EAAA,CACCC,SAACC,EAAA,KAAAC,EAAA,CAAKC,OAAO,OACXH,SAAA,CAAAF,EAAA,IAAC,SAAMM,KAAK,SAASC,KAAK,SAASC,MAAOZ,CAAQ,CAAA,QACjD,MAAI,CAAAa,UAAU,eACbP,SAACC,EAAA,KAAA,MAAA,CAAIM,UAAU,4CACbP,SAAA,CAACF,EAAA,IAAAU,EAAA,CAAwBD,UAAU,0BAA2B,CAAA,EAC7DT,EAAA,IAAA,KAAA,CAAGS,UAAU,wBAAwBP,SAAmB,qBAAA,CAAA,CAAA,CAC3D,CAAA,CACF,CAAA,EACAC,EAAA,KAAC,MAAI,CAAAM,UAAU,cACbP,SAAA,CAACC,EAAA,KAAA,MAAA,CAAIM,UAAU,gDACbP,SAAA,CAACF,EAAA,IAAA,KAAA,CAAGS,UAAU,2DAA2DP,SAEzE,wCAAA,CAAA,EACAC,EAAA,KAAC,KAAG,CAAAM,UAAU,kEACZP,SAAA,CAACC,EAAA,KAAA,KAAA,CAAGM,UAAU,oBACZP,SAAA,CAACF,EAAA,IAAAb,EAAA,CAAsBsB,UAAU,6BAA8B,CAAA,EAAE,iDAAA,CAEnE,CAAA,EACAN,EAAA,KAAC,KAAG,CAAAM,UAAU,oBACZP,SAAA,CAACF,EAAA,IAAAb,EAAA,CAAsBsB,UAAU,6BAA8B,CAAA,EAAE,6CAAA,CAEnE,CAAA,EACAN,EAAA,KAAC,KAAG,CAAAM,UAAU,oBACZP,SAAA,CAACF,EAAA,IAAAb,EAAA,CAAsBsB,UAAU,6BAA8B,CAAA,EAAE,kCAAA,CAEnE,CAAA,CAAA,CACF,CAAA,CAAA,CACF,CAAA,EACAN,EAAA,KAAC,MAAI,CAAAM,UAAU,4BACbP,SAAA,CAAAF,EAAA,IAACW,EAAA,CACCL,KAAK,SACLC,KAAK,UACLC,MAAM,SACNC,UAAU,kJAAkJP,SAAA,gBAAA,CAE9J,EACAF,EAAA,IAAC,SAAA,CACCM,KAAK,SACLM,QAASA,IAAMd,EAAS,EAAE,EAC1BW,UAAU,wLAAwLP,SAAA,QAAA,CAEpM,CAAA,CACF,CAAA,CAAA,CACF,CAAA,CAAA,CACF,CAAA,CACF,CAAA,CAEJ,CAEO,MAAMW,EAAgBC","x_google_ignoreList":[0]}