{"version":3,"file":"org_._orgId.completed-BWC13DQf.js","sources":["../../../node_modules/@heroicons/react/24/outline/esm/ArchiveBoxIcon.js","../../../node_modules/@heroicons/react/24/outline/esm/ArrowUpOnSquareStackIcon.js","../../../app/routes/_withNav+/_withSideBar+/_manage+/org_.$orgId.completed.tsx"],"sourcesContent":["import * as React from \"react\";\nfunction ArchiveBoxIcon({\n  title,\n  titleId,\n  ...props\n}, svgRef) {\n  return /*#__PURE__*/React.createElement(\"svg\", Object.assign({\n    xmlns: \"http://www.w3.org/2000/svg\",\n    fill: \"none\",\n    viewBox: \"0 0 24 24\",\n    strokeWidth: 1.5,\n    stroke: \"currentColor\",\n    \"aria-hidden\": \"true\",\n    \"data-slot\": \"icon\",\n    ref: svgRef,\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, /*#__PURE__*/React.createElement(\"path\", {\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\",\n    d: \"m20.25 7.5-.625 10.632a2.25 2.25 0 0 1-2.247 2.118H6.622a2.25 2.25 0 0 1-2.247-2.118L3.75 7.5M10 11.25h4M3.375 7.5h17.25c.621 0 1.125-.504 1.125-1.125v-1.5c0-.621-.504-1.125-1.125-1.125H3.375c-.621 0-1.125.504-1.125 1.125v1.5c0 .621.504 1.125 1.125 1.125Z\"\n  }));\n}\nconst ForwardRef = /*#__PURE__*/ React.forwardRef(ArchiveBoxIcon);\nexport default ForwardRef;","import * as React from \"react\";\nfunction ArrowUpOnSquareStackIcon({\n  title,\n  titleId,\n  ...props\n}, svgRef) {\n  return /*#__PURE__*/React.createElement(\"svg\", Object.assign({\n    xmlns: \"http://www.w3.org/2000/svg\",\n    fill: \"none\",\n    viewBox: \"0 0 24 24\",\n    strokeWidth: 1.5,\n    stroke: \"currentColor\",\n    \"aria-hidden\": \"true\",\n    \"data-slot\": \"icon\",\n    ref: svgRef,\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, /*#__PURE__*/React.createElement(\"path\", {\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\",\n    d: \"M7.5 7.5h-.75A2.25 2.25 0 0 0 4.5 9.75v7.5a2.25 2.25 0 0 0 2.25 2.25h7.5a2.25 2.25 0 0 0 2.25-2.25v-7.5a2.25 2.25 0 0 0-2.25-2.25h-.75m0-3-3-3m0 0-3 3m3-3v11.25m6-2.25h.75a2.25 2.25 0 0 1 2.25 2.25v7.5a2.25 2.25 0 0 1-2.25 2.25h-7.5a2.25 2.25 0 0 1-2.25-2.25v-.75\"\n  }));\n}\nconst ForwardRef = /*#__PURE__*/ React.forwardRef(ArrowUpOnSquareStackIcon);\nexport default ForwardRef;","import { LinkButton, PlayButton } from '@components/ui/Buttons';\nimport ErrorReport from '@components/ui/ErrorReport';\nimport PageHeader from '@components/ui/PageHeader';\nimport { Attribute } from '@lib/utils';\nimport type { ActionFunctionArgs, LoaderFunctionArgs } from '@remix-run/node';\nimport { json } from '@remix-run/node';\nimport { useFetcher, useLoaderData } from '@remix-run/react';\nimport { requireUser, requireUserAsObject } from '@services/user.server';\nimport { getArchivedMembers, getCompletedMembers, getOrgBeingViewed } from './.server/org.queries';\nimport { ArchiveBoxIcon, ArrowUpOnSquareStackIcon, CloudArrowDownIcon, DocumentCheckIcon, EyeIcon } from '@heroicons/react/24/outline';\nimport { AuthorizationError } from 'remix-auth';\nimport { jsonWithSuccess, jsonWithError } from 'remix-toast';\nimport { z } from 'zod';\nimport { resumeChecklist } from '../.server/tasks.queries';\nimport { ChecklistStatus } from '@prisma/client';\nimport { Input } from '@components/ui';\nimport { Badge } from '@components/ui/Badge';\n\nexport const loader = async ({ request, params }: LoaderFunctionArgs) => {\n  const { currentOrg } = await requireUserAsObject(request, {\n    permissions: Attribute.MOVES_READ,\n  });\n\n  const { orgId } = params;\n\n  if (!orgId) throw new Error('org id is required.');\n\n  const archived = await getArchivedMembers(orgId);\n  const completed = await getCompletedMembers(orgId);\n  const { orgBeingViewed } = await getOrgBeingViewed({\n    defaultOrgId: currentOrg.uuid,\n    searchParams: new URL(request.url).searchParams,\n    params,\n  });\n\n  return json({\n    archived,\n    completed,\n    orgBeingViewed,\n  });\n};\n\nexport async function action({ request }: ActionFunctionArgs) {\n  const updateTaskSchema = z.object({\n    itemId: z.string(),\n    _action: z.literal('resume'),\n  });\n\n  try {\n    const approvedUserId = await requireUser(request, {\n      options: { redirectOnFailure: false },\n      permissions: Attribute.TASKS_READWRITE,\n    });\n\n    const { itemId, _action } =\n      updateTaskSchema.parse(\n        Object.fromEntries((await request.formData()).entries())\n      );\n\n    if (_action === 'resume') {\n      await resumeChecklist(itemId, approvedUserId);\n      return jsonWithSuccess({ status: 'success' }, 'Checklist Resumed');\n    }\n  } catch (error) {\n    console.error('Error during approval: ', error);\n    if (error instanceof Error) {\n      if (error instanceof AuthorizationError) {\n        return jsonWithError(\n          { status: 'error', error: 'Authorization Error.' },\n          'User is not authorized.'\n        );\n      }\n      return jsonWithError(\n        { status: 'error', error: 'Failed to perform requested action' },\n        'There was an error.'\n      );\n    }\n  }\n}\n\nconst convertToCSV = (data) => {\n  const headers = ['Name', 'Status', 'Type', 'Checklist Progress', 'Last Updated'];\n  const rows = data.map((user) => {\n    const updatedAt = new Date(user.checklist.updatedAt).toDateString();\n    const status =\n      user.checklist.status === ChecklistStatus.Archived ? 'Archived' :\n        user.checklist.status === ChecklistStatus.InProgress ? 'In Progress' :\n          user.checklist.status === ChecklistStatus.Paused ? 'Paused' : '';\n\n    const progress = Math.round(user.checklist.count.completedItems / user.checklist.count.totalItems * 100);\n\n    return [\n      user.name,\n      status,\n      user.checklist.template.type,\n      `${progress}%`,\n      updatedAt,\n    ].join(',');\n  });\n\n  return [headers.join(','), ...rows].join('\\n');\n};\n\nconst downloadCSV = (data, filename = 'checklist.csv') => {\n  const csvContent = convertToCSV(data);\n  const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });\n  const url = URL.createObjectURL(blob);\n  \n  const link = document.createElement('a');\n  link.setAttribute('href', url);\n  link.setAttribute('download', filename);\n  link.style.visibility = 'hidden';\n  document.body.appendChild(link);\n  link.click();\n  document.body.removeChild(link);\n};\n\nconst InProcessedMembers = () => {\n  const { archived, completed, orgBeingViewed } = useLoaderData<typeof loader>();\n  const fetcher = useFetcher();\n\n  return (\n    <>\n      <PageHeader\n        org={orgBeingViewed}\n        pageTitle=\"Completed/Archived Checklists\"\n        navigateTo=\"completed\"/>\n  \n      {archived.length > 0 || completed.length > 0 ? (\n        <>\n          <div className=\"w-full flex justify-end\">\n            <button\n              type=\"button\"\n              onClick={() => downloadCSV(archived)}\n              className={`inline-flex justify-right px-4 py-1 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md shadow-sm hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-white`}>\n              <CloudArrowDownIcon className=\"w-5 h-5 mr-2\"/>\n              Export\n            </button>\n          </div>\n\n          <table className=\"text-left table-auto w-full border-neutral-300 border-1\">\n            <thead>\n              <tr className=\"border-b border-black\">\n                <th></th>\n                <th className=\"text-left\">Name</th>\n                <th>Status</th>\n                <th>Type</th>\n                <th className=\"text-center\">Checklist Progress</th>\n                <th className=\"w-56\">Last Updated</th>\n                <th className=\"pl-6 w-56\">Actions</th>\n              </tr>\n            </thead>\n            <tbody>\n              {[...archived, ...completed]\n                .sort((a, b) => (a.name ?? '').localeCompare(b.name ?? ''))\n                .map((user) => {\n                  const updatedAt = new Date(user.checklist.updatedAt).toDateString();\n\n                  return (\n                    <tr\n                      key={user.id}\n                      className=\"table-row border-b even:bg-zinc-50\">\n                      <td className=\"w-5 px-2\">\n                        {user.checklist.status === ChecklistStatus.Archived ? (\n                          <ArchiveBoxIcon className=\"h-5 w-5\" />\n                        ) : (\n                          <DocumentCheckIcon className=\"h-5 w-5\" />\n                        )}\n                      </td>\n                      <td className=\"py-2\">{user.name}</td>\n                      <td>\n                        {user.checklist.status === ChecklistStatus.Archived \n                          ? <Badge variant=\"warning\">Archived</Badge> \n                          : <Badge variant=\"green\">Completed</Badge>}\n                      </td>\n                      <td>{user.checklist.template.type}</td>\n                      <td className=\"text-center\">\n                        {Math.round(user.checklist.count.completedItems / user.checklist.count.totalItems * 100)}%\n                      </td>\n                      <td>{updatedAt}</td>\n                      <td>\n                        <div className=\"flex gap-2\">\n                          <fetcher.Form method=\"POST\">\n                            <Input.Hidden name=\"itemId\" value={user.checklist.id}></Input.Hidden>\n                            {user.checklist.status === ChecklistStatus.Archived ? (\n                              <PlayButton\n                                type=\"submit\"\n                                value=\"resume\"\n                                name=\"_action\"\n                                className=\"flex justify-center text-black items-center w-12\" \n                                title=\"Unarchive Checklist\">\n                                <ArrowUpOnSquareStackIcon className=\"h-5 w-5\" />\n                              </PlayButton>\n                            ) : (\n                              <div className=\"w-12\"></div>\n                            )}\n                          </fetcher.Form>\n                          <LinkButton\n                            to={`/org/${orgBeingViewed.uuid}/inprocess/${user.checklist.id}/view`}\n                            className=\"flex justify-center items-center w-12\" \n                            title=\"View Checklist\">\n                            <EyeIcon className=\"h-5 w-5\" />\n                          </LinkButton>\n                        </div>\n                      </td>\n                    </tr>\n                  );\n                })}\n            </tbody>\n          </table>\n        </>\n      ) : (\n        `No members to show.`\n      )}\n\n    </>\n\n  );\n};\n\nexport const ErrorBoundary = ErrorReport;\nexport default InProcessedMembers;"],"names":["ArchiveBoxIcon","title","titleId","props","svgRef","React.createElement","ForwardRef","React.forwardRef","ArrowUpOnSquareStackIcon","convertToCSV","data","headers","rows","map","user","updatedAt","Date","checklist","toDateString","status","ChecklistStatus","Archived","InProgress","Paused","progress","Math","round","count","completedItems","totalItems","name","template","type","join","downloadCSV","filename","csvContent","blob","Blob","url","URL","createObjectURL","link","document","createElement","setAttribute","style","visibility","body","appendChild","click","removeChild","InProcessedMembers","archived","completed","orgBeingViewed","useLoaderData","fetcher","useFetcher","jsxs","Fragment","children","jsx","PageHeader","org","pageTitle","navigateTo","length","className","onClick","CloudArrowDownIcon","sort","a","b","localeCompare","DocumentCheckIcon","Badge","variant","Form","method","Input","Hidden","value","id","PlayButton","LinkButton","to","uuid","EyeIcon","ErrorBoundary","ErrorReport"],"mappings":"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","x_google_ignoreList":[0,1]}